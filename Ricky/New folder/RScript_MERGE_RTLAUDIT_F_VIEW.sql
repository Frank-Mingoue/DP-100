-------------------MERGE_WC_RTLAUDIT_F VIEW MASTER-------------------------------------
BEGIN
       DECLARE @COUNTRY_CODE  NVARCHAR (50),
                     @SQL1 NVARCHAR(4000),
                     @SQL2 NVARCHAR(4000)
                     
                     
			BEGIN
			DECLARE COUNTRY_CURSOR CURSOR FOR 
       
				SELECT COUNTRY_CODE FROM  WC_BU_D 
				WHERE ROW_WID IN (
									SELECT ROW_WID FROM  WC_BU_D D
									 INNER JOIN  sys.tables ON COUNTRY_CODE = RIGHT(name,2)
								 WHERE name like 'MERGE_WC_RTLAUDIT_F%')                   
	         END     
         
SET @SQL1 ='IF  EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N''[dbo].[MERGE_WCV_RTLAUDIT_F_MASTER]''))
DROP VIEW [dbo].[MERGE_WCV_RTLAUDIT_F_MASTER]
GO
CREATE VIEW [dbo].[MERGE_WCV_RTLAUDIT_F_MASTER] (
[ACCT_GEO_WID],
[EMP_WID],
[ETL_PROC_WID],
[FACING_POS_WID],
[INTEGRATION_ID],
[INVLOC_WID],
[LAST_AUDIT_FLG],
[OBJECTIVE_WID],
[OWNER_POSTN_WID],
[PROD_WID],
[RECORD_DATE_WID],
[ROW_WID],
[STORE_WID],
[BACK_STOCK],
[DISPLAY_FLG],
[DISPLAY_STOCK],
[FACING_NUM],
[FEATURE_FLG],
[LAST_REPLENISH_DT],
[OUT_OF_STOCK_FLG],
[PRICE_PT],
[ROTATED_FLG],
[SHELF_STOCK],
[TPR_FLG],
[TPR_PCT],
[U_EXCH_DT],
[U_PRICE_PT],
[VOID_FLG],
[U_CURCY_CD],
[ROW_LOAD_DT],
[ATTRIB_06],
[FK_01_WID],
[ATTRIB_31],
[ATTRIB_92],
[ATTRIB_93],
[ATTRIB_96],
[ATTRIB_61],
[ATTRIB_62],
[ATTRIB_52],
[ATTRIB_91],
[FK_04_WID],
[ATTRIB_54],
[ATTRIB_55],
[ATTRIB_56],
[ATTRIB_57],
[ATTRIB_60],
[ATTRIB_102],
[ATTRIB_103],
[ATTRIB_104],
[ATTRIB_105],
[FK_05_WID],
[FK_06_WID],
[ATTRIB_106],
[ATTRIB_107],
[ATTRIB_108],
[X_BU_ID],
[ATTRIB_109],
[ATTRIB_110],
[ATTRIB_111],
[ATTRIB_112],
[ATTRIB_113],
[ATTRIB_114],
[ATTRIB_115],
[ATTRIB_116],
[ATTRIB_117],
[ATTRIB_118],
[ATTRIB_119],
[ATTRIB_120],
[MONTH_WID],
[X_EXPIRED_QTY_RECALL],
[X_LAST_REPLENISH_DT],
[X_SALESMEN_PRESENCE_FLG],
[X_UNKNOWN_SOURCE_FLG],
[X_AVAILABILITY],
[X_OUT_OF_STOCK_FLG],
[ACTIVITY_ID],
[ACTIVITY_ACTUAL_START_DT_WID],
[STOCK_NUM],
[X_QTY_MERCHANDISED],
[X_SUGGESTED_FLG],
[X_DAYS_NXT_ORD_NUM],
[ATTRIB_04],
[ATTRIB_05],
[ATTRIB_121],
[ATTRIB_122],
[ATTRIB_123],
[BRAND_WID],
[GEO_WID],
[GEO_SEC_WID],
[X_DOMESTIC_PRICE],
[X_AVAILABLE_STOCK_NUM],
[X_CONTRACTED_FLG],
[X_EXCHANGED_LABEL_NUM],
[X_RETRO_FLG],
[VISIT_INPUT_DT],
[X_IN_STOCK_CD],
[X_PMP_FLG],
[X_EXPIRED_PRODUCTS_FLG],
[RTLAUDIT_PREV_WID],
[PERIOD_WID],
[DEVELOPMENT_DAY_FLG],
[X_REASON_CODE],
[X_IMPORTANCE_INDICATOR],
[X_SELLING_CARTON_AMT],
[X_SELLING_CARTON_AMT_USD],
[X_NB_FACINGS_OOS],
[X_SKU_POS_CD1],
[X_SKU_POS_CD2],
[X_OOS_REASON_CD],
[X_CONTRACT_PRD_FLG],
[X_JTI_OOS_EXIT_REASON_CD],
[X_AUDIT_WRONG_FLG],
[X_AUDIT_COMMENTS_TEXT],
[X_STD_PRICE_PACK_REACHED],
[X_STD_PRICE_CARTON_REACHED],
[X_ATTRIBUTE_1],
[X_SKU_POS_CD4],
[PERFRM_BY_PER_ID],
[X_PRESALE_FLG],
[X_ACTUAL_ORD_QTY_NUM],
[DELETE_FLAG],
[RI_FLG],
[X_CARTON_PLATFORM_CD],
[X_CARTON_LOCATION_CD],
[X_PACK_LOCATION_CD],
[X_PACK_PLATFORM_CD],
[X_INDUSTRY_FIXTURE_CD],
[X_FIXTURE_SIZE_CD],
[LAST_CYCLE_FLG],
[LAST_CYCLE_EMP_FLG],
[X_FACING_IMP_NUM],
[X_BU_WID],
[PROD_POSITION],
[ACTIVITY_TYPE],
[PROD_IMPORTANCE],
[TARGET_POS],
[FACING_POS],
[X_OUT_STOCK_CD],
[X_SIS_CONTRACT_FLG])
AS'
PRINT @SQL1

   --Open the Country cursor
			  			          
	OPEN COUNTRY_CURSOR

    FETCH NEXT FROM COUNTRY_CURSOR 
              INTO @COUNTRY_CODE
              
     WHILE @@FETCH_STATUS = 0
     BEGIN  
          
SET @SQL2 ='SELECT
[ACCT_GEO_WID],
[EMP_WID],
[ETL_PROC_WID],
[FACING_POS_WID],
[INTEGRATION_ID],
[INVLOC_WID],
[LAST_AUDIT_FLG],
[OBJECTIVE_WID],
[OWNER_POSTN_WID],
[PROD_WID],
[RECORD_DATE_WID],
[ROW_WID],
[STORE_WID],
[BACK_STOCK],
[DISPLAY_FLG],
[DISPLAY_STOCK],
[FACING_NUM],
[FEATURE_FLG],
[LAST_REPLENISH_DT],
[OUT_OF_STOCK_FLG],
[PRICE_PT],
[ROTATED_FLG],
[SHELF_STOCK],
[TPR_FLG],
[TPR_PCT],
[U_EXCH_DT],
[U_PRICE_PT],
[VOID_FLG],
[U_CURCY_CD],
[ROW_LOAD_DT],
[ATTRIB_06],
[FK_01_WID],
[ATTRIB_31],
[ATTRIB_92],
[ATTRIB_93],
[ATTRIB_96],
[ATTRIB_61],
[ATTRIB_62],
[ATTRIB_52],
[ATTRIB_91],
[FK_04_WID],
[ATTRIB_54],
[ATTRIB_55],
[ATTRIB_56],
[ATTRIB_57],
[ATTRIB_60],
[ATTRIB_102],
[ATTRIB_103],
[ATTRIB_104],
[ATTRIB_105],
[FK_05_WID],
[FK_06_WID],
[ATTRIB_106],
[ATTRIB_107],
[ATTRIB_108],
[X_BU_ID],
[ATTRIB_109],
[ATTRIB_110],
[ATTRIB_111],
[ATTRIB_112],
[ATTRIB_113],
[ATTRIB_114],
[ATTRIB_115],
[ATTRIB_116],
[ATTRIB_117],
[ATTRIB_118],
[ATTRIB_119],
[ATTRIB_120],
[MONTH_WID],
[X_EXPIRED_QTY_RECALL],
[X_LAST_REPLENISH_DT],
[X_SALESMEN_PRESENCE_FLG],
[X_UNKNOWN_SOURCE_FLG],
[X_AVAILABILITY],
[X_OUT_OF_STOCK_FLG],
[ACTIVITY_ID],
[ACTIVITY_ACTUAL_START_DT_WID],
[STOCK_NUM],
[X_QTY_MERCHANDISED],
[X_SUGGESTED_FLG],
[X_DAYS_NXT_ORD_NUM],
[ATTRIB_04],
[ATTRIB_05],
[ATTRIB_121],
[ATTRIB_122],
[ATTRIB_123],
[BRAND_WID],
[GEO_WID],
[GEO_SEC_WID],
[X_DOMESTIC_PRICE],
[X_AVAILABLE_STOCK_NUM],
[X_CONTRACTED_FLG],
[X_EXCHANGED_LABEL_NUM],
[X_RETRO_FLG],
[VISIT_INPUT_DT],
[X_IN_STOCK_CD],
[X_PMP_FLG],
[X_EXPIRED_PRODUCTS_FLG],
[RTLAUDIT_PREV_WID],
[PERIOD_WID],
[DEVELOPMENT_DAY_FLG],
[X_REASON_CODE],
[X_IMPORTANCE_INDICATOR],
[X_SELLING_CARTON_AMT],
[X_SELLING_CARTON_AMT_USD],
[X_NB_FACINGS_OOS],
[X_SKU_POS_CD1],
[X_SKU_POS_CD2],
[X_OOS_REASON_CD],
[X_CONTRACT_PRD_FLG],
[X_JTI_OOS_EXIT_REASON_CD],
[X_AUDIT_WRONG_FLG],
[X_AUDIT_COMMENTS_TEXT],
[X_STD_PRICE_PACK_REACHED],
[X_STD_PRICE_CARTON_REACHED],
[X_ATTRIBUTE_1],
[X_SKU_POS_CD4],
[PERFRM_BY_PER_ID],
[X_PRESALE_FLG],
[X_ACTUAL_ORD_QTY_NUM],
[DELETE_FLAG],
[RI_FLG],
[X_CARTON_PLATFORM_CD],
[X_CARTON_LOCATION_CD],
[X_PACK_LOCATION_CD],
[X_PACK_PLATFORM_CD],
[X_INDUSTRY_FIXTURE_CD],
[X_FIXTURE_SIZE_CD],
[LAST_CYCLE_FLG],
[LAST_CYCLE_EMP_FLG],
[X_FACING_IMP_NUM],
[X_BU_WID],
[PROD_POSITION],
[ACTIVITY_TYPE],
[PROD_IMPORTANCE],
[TARGET_POS],
[FACING_POS],
[X_OUT_STOCK_CD],
[X_SIS_CONTRACT_FLG] FROM MERGE_WC_RTLAUDIT_F_'+@COUNTRY_CODE+' 
UNION ALL '
PRINT @SQL2
FETCH NEXT FROM COUNTRY_CURSOR INTO @COUNTRY_CODE
                  END
       
              CLOSE COUNTRY_CURSOR
              DEALLOCATE COUNTRY_CURSOR


END
GO
--------------------------------------------MERGE_WC_RTLAUDIT_F VIEW EU1-------------------------------------
BEGIN
       DECLARE @COUNTRY_CODE  NVARCHAR (50),
                     @SQL1 NVARCHAR(4000),
                     @SQL2 NVARCHAR(4000)
                     
                     
			BEGIN
			DECLARE COUNTRY_CURSOR CURSOR FOR 
       
				SELECT COUNTRY_CODE FROM  WC_BU_D 
				WHERE ROW_WID IN (
									SELECT ROW_WID FROM  WC_BU_D D
									 INNER JOIN  sys.tables ON COUNTRY_CODE = RIGHT(name,2)
								 WHERE name like 'MERGE_WC_RTLAUDIT_F%') AND COUNTRY_CODE IN ('IT','NL','BE','CH','FR')             
	         END    
SET @SQL1 ='IF  EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N''[dbo].[MERGE_WCV_RTLAUDIT_F_EU1]''))
DROP VIEW [dbo].[MERGE_WCV_RTLAUDIT_F_EU1]
GO
CREATE VIEW [dbo].[MERGE_WCV_RTLAUDIT_F_EU1] (
[ACCT_GEO_WID],
[EMP_WID],
[ETL_PROC_WID],
[FACING_POS_WID],
[INTEGRATION_ID],
[INVLOC_WID],
[LAST_AUDIT_FLG],
[OBJECTIVE_WID],
[OWNER_POSTN_WID],
[PROD_WID],
[RECORD_DATE_WID],
[ROW_WID],
[STORE_WID],
[BACK_STOCK],
[DISPLAY_FLG],
[DISPLAY_STOCK],
[FACING_NUM],
[FEATURE_FLG],
[LAST_REPLENISH_DT],
[OUT_OF_STOCK_FLG],
[PRICE_PT],
[ROTATED_FLG],
[SHELF_STOCK],
[TPR_FLG],
[TPR_PCT],
[U_EXCH_DT],
[U_PRICE_PT],
[VOID_FLG],
[U_CURCY_CD],
[ROW_LOAD_DT],
[ATTRIB_06],
[FK_01_WID],
[ATTRIB_31],
[ATTRIB_92],
[ATTRIB_93],
[ATTRIB_96],
[ATTRIB_61],
[ATTRIB_62],
[ATTRIB_52],
[ATTRIB_91],
[FK_04_WID],
[ATTRIB_54],
[ATTRIB_55],
[ATTRIB_56],
[ATTRIB_57],
[ATTRIB_60],
[ATTRIB_102],
[ATTRIB_103],
[ATTRIB_104],
[ATTRIB_105],
[FK_05_WID],
[FK_06_WID],
[ATTRIB_106],
[ATTRIB_107],
[ATTRIB_108],
[X_BU_ID],
[ATTRIB_109],
[ATTRIB_110],
[ATTRIB_111],
[ATTRIB_112],
[ATTRIB_113],
[ATTRIB_114],
[ATTRIB_115],
[ATTRIB_116],
[ATTRIB_117],
[ATTRIB_118],
[ATTRIB_119],
[ATTRIB_120],
[MONTH_WID],
[X_EXPIRED_QTY_RECALL],
[X_LAST_REPLENISH_DT],
[X_SALESMEN_PRESENCE_FLG],
[X_UNKNOWN_SOURCE_FLG],
[X_AVAILABILITY],
[X_OUT_OF_STOCK_FLG],
[ACTIVITY_ID],
[ACTIVITY_ACTUAL_START_DT_WID],
[STOCK_NUM],
[X_QTY_MERCHANDISED],
[X_SUGGESTED_FLG],
[X_DAYS_NXT_ORD_NUM],
[ATTRIB_04],
[ATTRIB_05],
[ATTRIB_121],
[ATTRIB_122],
[ATTRIB_123],
[BRAND_WID],
[GEO_WID],
[GEO_SEC_WID],
[X_DOMESTIC_PRICE],
[X_AVAILABLE_STOCK_NUM],
[X_CONTRACTED_FLG],
[X_EXCHANGED_LABEL_NUM],
[X_RETRO_FLG],
[VISIT_INPUT_DT],
[X_IN_STOCK_CD],
[X_PMP_FLG],
[X_EXPIRED_PRODUCTS_FLG],
[RTLAUDIT_PREV_WID],
[PERIOD_WID],
[DEVELOPMENT_DAY_FLG],
[X_REASON_CODE],
[X_IMPORTANCE_INDICATOR],
[X_SELLING_CARTON_AMT],
[X_SELLING_CARTON_AMT_USD],
[X_NB_FACINGS_OOS],
[X_SKU_POS_CD1],
[X_SKU_POS_CD2],
[X_OOS_REASON_CD],
[X_CONTRACT_PRD_FLG],
[X_JTI_OOS_EXIT_REASON_CD],
[X_AUDIT_WRONG_FLG],
[X_AUDIT_COMMENTS_TEXT],
[X_STD_PRICE_PACK_REACHED],
[X_STD_PRICE_CARTON_REACHED],
[X_ATTRIBUTE_1],
[X_SKU_POS_CD4],
[PERFRM_BY_PER_ID],
[X_PRESALE_FLG],
[X_ACTUAL_ORD_QTY_NUM],
[DELETE_FLAG],
[RI_FLG],
[X_CARTON_PLATFORM_CD],
[X_CARTON_LOCATION_CD],
[X_PACK_LOCATION_CD],
[X_PACK_PLATFORM_CD],
[X_INDUSTRY_FIXTURE_CD],
[X_FIXTURE_SIZE_CD],
[LAST_CYCLE_FLG],
[LAST_CYCLE_EMP_FLG],
[X_FACING_IMP_NUM],
[X_BU_WID],
[PROD_POSITION],
[ACTIVITY_TYPE],
[PROD_IMPORTANCE],
[TARGET_POS],
[FACING_POS],
[X_OUT_STOCK_CD],
[X_SIS_CONTRACT_FLG])
AS'
PRINT @SQL1

   --Open the Country cursor
			  			          
	OPEN COUNTRY_CURSOR

    FETCH NEXT FROM COUNTRY_CURSOR 
              INTO @COUNTRY_CODE
              
     WHILE @@FETCH_STATUS = 0
     BEGIN  
          
SET @SQL2 ='SELECT
[ACCT_GEO_WID],
[EMP_WID],
[ETL_PROC_WID],
[FACING_POS_WID],
[INTEGRATION_ID],
[INVLOC_WID],
[LAST_AUDIT_FLG],
[OBJECTIVE_WID],
[OWNER_POSTN_WID],
[PROD_WID],
[RECORD_DATE_WID],
[ROW_WID],
[STORE_WID],
[BACK_STOCK],
[DISPLAY_FLG],
[DISPLAY_STOCK],
[FACING_NUM],
[FEATURE_FLG],
[LAST_REPLENISH_DT],
[OUT_OF_STOCK_FLG],
[PRICE_PT],
[ROTATED_FLG],
[SHELF_STOCK],
[TPR_FLG],
[TPR_PCT],
[U_EXCH_DT],
[U_PRICE_PT],
[VOID_FLG],
[U_CURCY_CD],
[ROW_LOAD_DT],
[ATTRIB_06],
[FK_01_WID],
[ATTRIB_31],
[ATTRIB_92],
[ATTRIB_93],
[ATTRIB_96],
[ATTRIB_61],
[ATTRIB_62],
[ATTRIB_52],
[ATTRIB_91],
[FK_04_WID],
[ATTRIB_54],
[ATTRIB_55],
[ATTRIB_56],
[ATTRIB_57],
[ATTRIB_60],
[ATTRIB_102],
[ATTRIB_103],
[ATTRIB_104],
[ATTRIB_105],
[FK_05_WID],
[FK_06_WID],
[ATTRIB_106],
[ATTRIB_107],
[ATTRIB_108],
[X_BU_ID],
[ATTRIB_109],
[ATTRIB_110],
[ATTRIB_111],
[ATTRIB_112],
[ATTRIB_113],
[ATTRIB_114],
[ATTRIB_115],
[ATTRIB_116],
[ATTRIB_117],
[ATTRIB_118],
[ATTRIB_119],
[ATTRIB_120],
[MONTH_WID],
[X_EXPIRED_QTY_RECALL],
[X_LAST_REPLENISH_DT],
[X_SALESMEN_PRESENCE_FLG],
[X_UNKNOWN_SOURCE_FLG],
[X_AVAILABILITY],
[X_OUT_OF_STOCK_FLG],
[ACTIVITY_ID],
[ACTIVITY_ACTUAL_START_DT_WID],
[STOCK_NUM],
[X_QTY_MERCHANDISED],
[X_SUGGESTED_FLG],
[X_DAYS_NXT_ORD_NUM],
[ATTRIB_04],
[ATTRIB_05],
[ATTRIB_121],
[ATTRIB_122],
[ATTRIB_123],
[BRAND_WID],
[GEO_WID],
[GEO_SEC_WID],
[X_DOMESTIC_PRICE],
[X_AVAILABLE_STOCK_NUM],
[X_CONTRACTED_FLG],
[X_EXCHANGED_LABEL_NUM],
[X_RETRO_FLG],
[VISIT_INPUT_DT],
[X_IN_STOCK_CD],
[X_PMP_FLG],
[X_EXPIRED_PRODUCTS_FLG],
[RTLAUDIT_PREV_WID],
[PERIOD_WID],
[DEVELOPMENT_DAY_FLG],
[X_REASON_CODE],
[X_IMPORTANCE_INDICATOR],
[X_SELLING_CARTON_AMT],
[X_SELLING_CARTON_AMT_USD],
[X_NB_FACINGS_OOS],
[X_SKU_POS_CD1],
[X_SKU_POS_CD2],
[X_OOS_REASON_CD],
[X_CONTRACT_PRD_FLG],
[X_JTI_OOS_EXIT_REASON_CD],
[X_AUDIT_WRONG_FLG],
[X_AUDIT_COMMENTS_TEXT],
[X_STD_PRICE_PACK_REACHED],
[X_STD_PRICE_CARTON_REACHED],
[X_ATTRIBUTE_1],
[X_SKU_POS_CD4],
[PERFRM_BY_PER_ID],
[X_PRESALE_FLG],
[X_ACTUAL_ORD_QTY_NUM],
[DELETE_FLAG],
[RI_FLG],
[X_CARTON_PLATFORM_CD],
[X_CARTON_LOCATION_CD],
[X_PACK_LOCATION_CD],
[X_PACK_PLATFORM_CD],
[X_INDUSTRY_FIXTURE_CD],
[X_FIXTURE_SIZE_CD],
[LAST_CYCLE_FLG],
[LAST_CYCLE_EMP_FLG],
[X_FACING_IMP_NUM],
[X_BU_WID],
[PROD_POSITION],
[ACTIVITY_TYPE],
[PROD_IMPORTANCE],
[TARGET_POS],
[FACING_POS],
[X_OUT_STOCK_CD],
[X_SIS_CONTRACT_FLG] FROM MERGE_WC_RTLAUDIT_F_'+@COUNTRY_CODE+' 
UNION ALL '
PRINT @SQL2

FETCH NEXT FROM COUNTRY_CURSOR INTO @COUNTRY_CODE
                  END
       
              CLOSE COUNTRY_CURSOR
              DEALLOCATE COUNTRY_CURSOR

END
GO
--------------------------------------------MERGE_WC_RTLAUDIT_F VIEW EU2-------------------------------------
BEGIN
       DECLARE @COUNTRY_CODE  NVARCHAR (50),
                     @SQL1 NVARCHAR(4000),
                     @SQL2 NVARCHAR(4000)
                     
                     
			BEGIN
			DECLARE COUNTRY_CURSOR CURSOR FOR 
       
				SELECT COUNTRY_CODE FROM  WC_BU_D 
				WHERE ROW_WID IN (
									SELECT ROW_WID FROM  WC_BU_D D
									 INNER JOIN  sys.tables ON COUNTRY_CODE = RIGHT(name,2)
								 WHERE name like 'MERGE_WC_RTLAUDIT_F%') AND COUNTRY_CODE IN ('ES','CA','IE','AT','PT','SE','CI')             
	         END    
SET @SQL1 ='IF  EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N''[dbo].[MERGE_WCV_RTLAUDIT_F_EU2]''))
DROP VIEW [dbo].[MERGE_WCV_RTLAUDIT_F_EU2]
GO
CREATE VIEW [dbo].[MERGE_WCV_RTLAUDIT_F_EU2] (
[ACCT_GEO_WID],
[EMP_WID],
[ETL_PROC_WID],
[FACING_POS_WID],
[INTEGRATION_ID],
[INVLOC_WID],
[LAST_AUDIT_FLG],
[OBJECTIVE_WID],
[OWNER_POSTN_WID],
[PROD_WID],
[RECORD_DATE_WID],
[ROW_WID],
[STORE_WID],
[BACK_STOCK],
[DISPLAY_FLG],
[DISPLAY_STOCK],
[FACING_NUM],
[FEATURE_FLG],
[LAST_REPLENISH_DT],
[OUT_OF_STOCK_FLG],
[PRICE_PT],
[ROTATED_FLG],
[SHELF_STOCK],
[TPR_FLG],
[TPR_PCT],
[U_EXCH_DT],
[U_PRICE_PT],
[VOID_FLG],
[U_CURCY_CD],
[ROW_LOAD_DT],
[ATTRIB_06],
[FK_01_WID],
[ATTRIB_31],
[ATTRIB_92],
[ATTRIB_93],
[ATTRIB_96],
[ATTRIB_61],
[ATTRIB_62],
[ATTRIB_52],
[ATTRIB_91],
[FK_04_WID],
[ATTRIB_54],
[ATTRIB_55],
[ATTRIB_56],
[ATTRIB_57],
[ATTRIB_60],
[ATTRIB_102],
[ATTRIB_103],
[ATTRIB_104],
[ATTRIB_105],
[FK_05_WID],
[FK_06_WID],
[ATTRIB_106],
[ATTRIB_107],
[ATTRIB_108],
[X_BU_ID],
[ATTRIB_109],
[ATTRIB_110],
[ATTRIB_111],
[ATTRIB_112],
[ATTRIB_113],
[ATTRIB_114],
[ATTRIB_115],
[ATTRIB_116],
[ATTRIB_117],
[ATTRIB_118],
[ATTRIB_119],
[ATTRIB_120],
[MONTH_WID],
[X_EXPIRED_QTY_RECALL],
[X_LAST_REPLENISH_DT],
[X_SALESMEN_PRESENCE_FLG],
[X_UNKNOWN_SOURCE_FLG],
[X_AVAILABILITY],
[X_OUT_OF_STOCK_FLG],
[ACTIVITY_ID],
[ACTIVITY_ACTUAL_START_DT_WID],
[STOCK_NUM],
[X_QTY_MERCHANDISED],
[X_SUGGESTED_FLG],
[X_DAYS_NXT_ORD_NUM],
[ATTRIB_04],
[ATTRIB_05],
[ATTRIB_121],
[ATTRIB_122],
[ATTRIB_123],
[BRAND_WID],
[GEO_WID],
[GEO_SEC_WID],
[X_DOMESTIC_PRICE],
[X_AVAILABLE_STOCK_NUM],
[X_CONTRACTED_FLG],
[X_EXCHANGED_LABEL_NUM],
[X_RETRO_FLG],
[VISIT_INPUT_DT],
[X_IN_STOCK_CD],
[X_PMP_FLG],
[X_EXPIRED_PRODUCTS_FLG],
[RTLAUDIT_PREV_WID],
[PERIOD_WID],
[DEVELOPMENT_DAY_FLG],
[X_REASON_CODE],
[X_IMPORTANCE_INDICATOR],
[X_SELLING_CARTON_AMT],
[X_SELLING_CARTON_AMT_USD],
[X_NB_FACINGS_OOS],
[X_SKU_POS_CD1],
[X_SKU_POS_CD2],
[X_OOS_REASON_CD],
[X_CONTRACT_PRD_FLG],
[X_JTI_OOS_EXIT_REASON_CD],
[X_AUDIT_WRONG_FLG],
[X_AUDIT_COMMENTS_TEXT],
[X_STD_PRICE_PACK_REACHED],
[X_STD_PRICE_CARTON_REACHED],
[X_ATTRIBUTE_1],
[X_SKU_POS_CD4],
[PERFRM_BY_PER_ID],
[X_PRESALE_FLG],
[X_ACTUAL_ORD_QTY_NUM],
[DELETE_FLAG],
[RI_FLG],
[X_CARTON_PLATFORM_CD],
[X_CARTON_LOCATION_CD],
[X_PACK_LOCATION_CD],
[X_PACK_PLATFORM_CD],
[X_INDUSTRY_FIXTURE_CD],
[X_FIXTURE_SIZE_CD],
[LAST_CYCLE_FLG],
[LAST_CYCLE_EMP_FLG],
[X_FACING_IMP_NUM],
[X_BU_WID],
[PROD_POSITION],
[ACTIVITY_TYPE],
[PROD_IMPORTANCE],
[TARGET_POS],
[FACING_POS],
[X_OUT_STOCK_CD],
[X_SIS_CONTRACT_FLG])
AS'
PRINT @SQL1

   --Open the Country cursor
			  			          
	OPEN COUNTRY_CURSOR

    FETCH NEXT FROM COUNTRY_CURSOR 
              INTO @COUNTRY_CODE
              
     WHILE @@FETCH_STATUS = 0
     BEGIN  
          
SET @SQL2 ='SELECT
[ACCT_GEO_WID],
[EMP_WID],
[ETL_PROC_WID],
[FACING_POS_WID],
[INTEGRATION_ID],
[INVLOC_WID],
[LAST_AUDIT_FLG],
[OBJECTIVE_WID],
[OWNER_POSTN_WID],
[PROD_WID],
[RECORD_DATE_WID],
[ROW_WID],
[STORE_WID],
[BACK_STOCK],
[DISPLAY_FLG],
[DISPLAY_STOCK],
[FACING_NUM],
[FEATURE_FLG],
[LAST_REPLENISH_DT],
[OUT_OF_STOCK_FLG],
[PRICE_PT],
[ROTATED_FLG],
[SHELF_STOCK],
[TPR_FLG],
[TPR_PCT],
[U_EXCH_DT],
[U_PRICE_PT],
[VOID_FLG],
[U_CURCY_CD],
[ROW_LOAD_DT],
[ATTRIB_06],
[FK_01_WID],
[ATTRIB_31],
[ATTRIB_92],
[ATTRIB_93],
[ATTRIB_96],
[ATTRIB_61],
[ATTRIB_62],
[ATTRIB_52],
[ATTRIB_91],
[FK_04_WID],
[ATTRIB_54],
[ATTRIB_55],
[ATTRIB_56],
[ATTRIB_57],
[ATTRIB_60],
[ATTRIB_102],
[ATTRIB_103],
[ATTRIB_104],
[ATTRIB_105],
[FK_05_WID],
[FK_06_WID],
[ATTRIB_106],
[ATTRIB_107],
[ATTRIB_108],
[X_BU_ID],
[ATTRIB_109],
[ATTRIB_110],
[ATTRIB_111],
[ATTRIB_112],
[ATTRIB_113],
[ATTRIB_114],
[ATTRIB_115],
[ATTRIB_116],
[ATTRIB_117],
[ATTRIB_118],
[ATTRIB_119],
[ATTRIB_120],
[MONTH_WID],
[X_EXPIRED_QTY_RECALL],
[X_LAST_REPLENISH_DT],
[X_SALESMEN_PRESENCE_FLG],
[X_UNKNOWN_SOURCE_FLG],
[X_AVAILABILITY],
[X_OUT_OF_STOCK_FLG],
[ACTIVITY_ID],
[ACTIVITY_ACTUAL_START_DT_WID],
[STOCK_NUM],
[X_QTY_MERCHANDISED],
[X_SUGGESTED_FLG],
[X_DAYS_NXT_ORD_NUM],
[ATTRIB_04],
[ATTRIB_05],
[ATTRIB_121],
[ATTRIB_122],
[ATTRIB_123],
[BRAND_WID],
[GEO_WID],
[GEO_SEC_WID],
[X_DOMESTIC_PRICE],
[X_AVAILABLE_STOCK_NUM],
[X_CONTRACTED_FLG],
[X_EXCHANGED_LABEL_NUM],
[X_RETRO_FLG],
[VISIT_INPUT_DT],
[X_IN_STOCK_CD],
[X_PMP_FLG],
[X_EXPIRED_PRODUCTS_FLG],
[RTLAUDIT_PREV_WID],
[PERIOD_WID],
[DEVELOPMENT_DAY_FLG],
[X_REASON_CODE],
[X_IMPORTANCE_INDICATOR],
[X_SELLING_CARTON_AMT],
[X_SELLING_CARTON_AMT_USD],
[X_NB_FACINGS_OOS],
[X_SKU_POS_CD1],
[X_SKU_POS_CD2],
[X_OOS_REASON_CD],
[X_CONTRACT_PRD_FLG],
[X_JTI_OOS_EXIT_REASON_CD],
[X_AUDIT_WRONG_FLG],
[X_AUDIT_COMMENTS_TEXT],
[X_STD_PRICE_PACK_REACHED],
[X_STD_PRICE_CARTON_REACHED],
[X_ATTRIBUTE_1],
[X_SKU_POS_CD4],
[PERFRM_BY_PER_ID],
[X_PRESALE_FLG],
[X_ACTUAL_ORD_QTY_NUM],
[DELETE_FLAG],
[RI_FLG],
[X_CARTON_PLATFORM_CD],
[X_CARTON_LOCATION_CD],
[X_PACK_LOCATION_CD],
[X_PACK_PLATFORM_CD],
[X_INDUSTRY_FIXTURE_CD],
[X_FIXTURE_SIZE_CD],
[LAST_CYCLE_FLG],
[LAST_CYCLE_EMP_FLG],
[X_FACING_IMP_NUM],
[X_BU_WID],
[PROD_POSITION],
[ACTIVITY_TYPE],
[PROD_IMPORTANCE],
[TARGET_POS],
[FACING_POS],
[X_OUT_STOCK_CD],
[X_SIS_CONTRACT_FLG] FROM MERGE_WC_RTLAUDIT_F_'+@COUNTRY_CODE+' 
UNION ALL '
PRINT @SQL2

FETCH NEXT FROM COUNTRY_CURSOR INTO @COUNTRY_CODE
                  END
       
              CLOSE COUNTRY_CURSOR
              DEALLOCATE COUNTRY_CURSOR

END
GO
--------------------------------------------MERGE_WC_RTLAUDIT_F VIEW EU3-------------------------------------
BEGIN
       DECLARE @COUNTRY_CODE  NVARCHAR (50),
                     @SQL1 NVARCHAR(4000),
                     @SQL2 NVARCHAR(4000)
                     
                     
			BEGIN
			DECLARE COUNTRY_CURSOR CURSOR FOR 
       
				SELECT COUNTRY_CODE FROM  WC_BU_D 
				WHERE ROW_WID IN (
									SELECT ROW_WID FROM  WC_BU_D D
									 INNER JOIN  sys.tables ON COUNTRY_CODE = RIGHT(name,2)
								 WHERE name like 'MERGE_WC_RTLAUDIT_F%') AND COUNTRY_CODE IN ('UK','US')             
	         END    
SET @SQL1 ='IF  EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N''[dbo].[MERGE_WCV_RTLAUDIT_F_EU3]''))
DROP VIEW [dbo].[MERGE_WCV_RTLAUDIT_F_EU3]
GO
CREATE VIEW [dbo].[MERGE_WCV_RTLAUDIT_F_EU3] (
[ACCT_GEO_WID],
[EMP_WID],
[ETL_PROC_WID],
[FACING_POS_WID],
[INTEGRATION_ID],
[INVLOC_WID],
[LAST_AUDIT_FLG],
[OBJECTIVE_WID],
[OWNER_POSTN_WID],
[PROD_WID],
[RECORD_DATE_WID],
[ROW_WID],
[STORE_WID],
[BACK_STOCK],
[DISPLAY_FLG],
[DISPLAY_STOCK],
[FACING_NUM],
[FEATURE_FLG],
[LAST_REPLENISH_DT],
[OUT_OF_STOCK_FLG],
[PRICE_PT],
[ROTATED_FLG],
[SHELF_STOCK],
[TPR_FLG],
[TPR_PCT],
[U_EXCH_DT],
[U_PRICE_PT],
[VOID_FLG],
[U_CURCY_CD],
[ROW_LOAD_DT],
[ATTRIB_06],
[FK_01_WID],
[ATTRIB_31],
[ATTRIB_92],
[ATTRIB_93],
[ATTRIB_96],
[ATTRIB_61],
[ATTRIB_62],
[ATTRIB_52],
[ATTRIB_91],
[FK_04_WID],
[ATTRIB_54],
[ATTRIB_55],
[ATTRIB_56],
[ATTRIB_57],
[ATTRIB_60],
[ATTRIB_102],
[ATTRIB_103],
[ATTRIB_104],
[ATTRIB_105],
[FK_05_WID],
[FK_06_WID],
[ATTRIB_106],
[ATTRIB_107],
[ATTRIB_108],
[X_BU_ID],
[ATTRIB_109],
[ATTRIB_110],
[ATTRIB_111],
[ATTRIB_112],
[ATTRIB_113],
[ATTRIB_114],
[ATTRIB_115],
[ATTRIB_116],
[ATTRIB_117],
[ATTRIB_118],
[ATTRIB_119],
[ATTRIB_120],
[MONTH_WID],
[X_EXPIRED_QTY_RECALL],
[X_LAST_REPLENISH_DT],
[X_SALESMEN_PRESENCE_FLG],
[X_UNKNOWN_SOURCE_FLG],
[X_AVAILABILITY],
[X_OUT_OF_STOCK_FLG],
[ACTIVITY_ID],
[ACTIVITY_ACTUAL_START_DT_WID],
[STOCK_NUM],
[X_QTY_MERCHANDISED],
[X_SUGGESTED_FLG],
[X_DAYS_NXT_ORD_NUM],
[ATTRIB_04],
[ATTRIB_05],
[ATTRIB_121],
[ATTRIB_122],
[ATTRIB_123],
[BRAND_WID],
[GEO_WID],
[GEO_SEC_WID],
[X_DOMESTIC_PRICE],
[X_AVAILABLE_STOCK_NUM],
[X_CONTRACTED_FLG],
[X_EXCHANGED_LABEL_NUM],
[X_RETRO_FLG],
[VISIT_INPUT_DT],
[X_IN_STOCK_CD],
[X_PMP_FLG],
[X_EXPIRED_PRODUCTS_FLG],
[RTLAUDIT_PREV_WID],
[PERIOD_WID],
[DEVELOPMENT_DAY_FLG],
[X_REASON_CODE],
[X_IMPORTANCE_INDICATOR],
[X_SELLING_CARTON_AMT],
[X_SELLING_CARTON_AMT_USD],
[X_NB_FACINGS_OOS],
[X_SKU_POS_CD1],
[X_SKU_POS_CD2],
[X_OOS_REASON_CD],
[X_CONTRACT_PRD_FLG],
[X_JTI_OOS_EXIT_REASON_CD],
[X_AUDIT_WRONG_FLG],
[X_AUDIT_COMMENTS_TEXT],
[X_STD_PRICE_PACK_REACHED],
[X_STD_PRICE_CARTON_REACHED],
[X_ATTRIBUTE_1],
[X_SKU_POS_CD4],
[PERFRM_BY_PER_ID],
[X_PRESALE_FLG],
[X_ACTUAL_ORD_QTY_NUM],
[DELETE_FLAG],
[RI_FLG],
[X_CARTON_PLATFORM_CD],
[X_CARTON_LOCATION_CD],
[X_PACK_LOCATION_CD],
[X_PACK_PLATFORM_CD],
[X_INDUSTRY_FIXTURE_CD],
[X_FIXTURE_SIZE_CD],
[LAST_CYCLE_FLG],
[LAST_CYCLE_EMP_FLG],
[X_FACING_IMP_NUM],
[X_BU_WID],
[PROD_POSITION],
[ACTIVITY_TYPE],
[PROD_IMPORTANCE],
[TARGET_POS],
[FACING_POS],
[X_OUT_STOCK_CD],
[X_SIS_CONTRACT_FLG])
AS'
PRINT @SQL1

   --Open the Country cursor
			  			          
	OPEN COUNTRY_CURSOR

    FETCH NEXT FROM COUNTRY_CURSOR 
              INTO @COUNTRY_CODE
              
     WHILE @@FETCH_STATUS = 0
     BEGIN  
          
SET @SQL2 ='SELECT
[ACCT_GEO_WID],
[EMP_WID],
[ETL_PROC_WID],
[FACING_POS_WID],
[INTEGRATION_ID],
[INVLOC_WID],
[LAST_AUDIT_FLG],
[OBJECTIVE_WID],
[OWNER_POSTN_WID],
[PROD_WID],
[RECORD_DATE_WID],
[ROW_WID],
[STORE_WID],
[BACK_STOCK],
[DISPLAY_FLG],
[DISPLAY_STOCK],
[FACING_NUM],
[FEATURE_FLG],
[LAST_REPLENISH_DT],
[OUT_OF_STOCK_FLG],
[PRICE_PT],
[ROTATED_FLG],
[SHELF_STOCK],
[TPR_FLG],
[TPR_PCT],
[U_EXCH_DT],
[U_PRICE_PT],
[VOID_FLG],
[U_CURCY_CD],
[ROW_LOAD_DT],
[ATTRIB_06],
[FK_01_WID],
[ATTRIB_31],
[ATTRIB_92],
[ATTRIB_93],
[ATTRIB_96],
[ATTRIB_61],
[ATTRIB_62],
[ATTRIB_52],
[ATTRIB_91],
[FK_04_WID],
[ATTRIB_54],
[ATTRIB_55],
[ATTRIB_56],
[ATTRIB_57],
[ATTRIB_60],
[ATTRIB_102],
[ATTRIB_103],
[ATTRIB_104],
[ATTRIB_105],
[FK_05_WID],
[FK_06_WID],
[ATTRIB_106],
[ATTRIB_107],
[ATTRIB_108],
[X_BU_ID],
[ATTRIB_109],
[ATTRIB_110],
[ATTRIB_111],
[ATTRIB_112],
[ATTRIB_113],
[ATTRIB_114],
[ATTRIB_115],
[ATTRIB_116],
[ATTRIB_117],
[ATTRIB_118],
[ATTRIB_119],
[ATTRIB_120],
[MONTH_WID],
[X_EXPIRED_QTY_RECALL],
[X_LAST_REPLENISH_DT],
[X_SALESMEN_PRESENCE_FLG],
[X_UNKNOWN_SOURCE_FLG],
[X_AVAILABILITY],
[X_OUT_OF_STOCK_FLG],
[ACTIVITY_ID],
[ACTIVITY_ACTUAL_START_DT_WID],
[STOCK_NUM],
[X_QTY_MERCHANDISED],
[X_SUGGESTED_FLG],
[X_DAYS_NXT_ORD_NUM],
[ATTRIB_04],
[ATTRIB_05],
[ATTRIB_121],
[ATTRIB_122],
[ATTRIB_123],
[BRAND_WID],
[GEO_WID],
[GEO_SEC_WID],
[X_DOMESTIC_PRICE],
[X_AVAILABLE_STOCK_NUM],
[X_CONTRACTED_FLG],
[X_EXCHANGED_LABEL_NUM],
[X_RETRO_FLG],
[VISIT_INPUT_DT],
[X_IN_STOCK_CD],
[X_PMP_FLG],
[X_EXPIRED_PRODUCTS_FLG],
[RTLAUDIT_PREV_WID],
[PERIOD_WID],
[DEVELOPMENT_DAY_FLG],
[X_REASON_CODE],
[X_IMPORTANCE_INDICATOR],
[X_SELLING_CARTON_AMT],
[X_SELLING_CARTON_AMT_USD],
[X_NB_FACINGS_OOS],
[X_SKU_POS_CD1],
[X_SKU_POS_CD2],
[X_OOS_REASON_CD],
[X_CONTRACT_PRD_FLG],
[X_JTI_OOS_EXIT_REASON_CD],
[X_AUDIT_WRONG_FLG],
[X_AUDIT_COMMENTS_TEXT],
[X_STD_PRICE_PACK_REACHED],
[X_STD_PRICE_CARTON_REACHED],
[X_ATTRIBUTE_1],
[X_SKU_POS_CD4],
[PERFRM_BY_PER_ID],
[X_PRESALE_FLG],
[X_ACTUAL_ORD_QTY_NUM],
[DELETE_FLAG],
[RI_FLG],
[X_CARTON_PLATFORM_CD],
[X_CARTON_LOCATION_CD],
[X_PACK_LOCATION_CD],
[X_PACK_PLATFORM_CD],
[X_INDUSTRY_FIXTURE_CD],
[X_FIXTURE_SIZE_CD],
[LAST_CYCLE_FLG],
[LAST_CYCLE_EMP_FLG],
[X_FACING_IMP_NUM],
[X_BU_WID],
[PROD_POSITION],
[ACTIVITY_TYPE],
[PROD_IMPORTANCE],
[TARGET_POS],
[FACING_POS],
[X_OUT_STOCK_CD],
[X_SIS_CONTRACT_FLG] FROM MERGE_WC_RTLAUDIT_F_'+@COUNTRY_CODE+' 
UNION ALL '
PRINT @SQL2

FETCH NEXT FROM COUNTRY_CURSOR INTO @COUNTRY_CODE
                  END
       
              CLOSE COUNTRY_CURSOR
              DEALLOCATE COUNTRY_CURSOR

END
GO
--------------------------------------------MERGE_WC_RTLAUDIT_F VIEW CIS-------------------------------------
BEGIN
       DECLARE @COUNTRY_CODE  NVARCHAR (50),
                     @SQL1 NVARCHAR(4000),
                     @SQL2 NVARCHAR(4000)
                     
                     
			BEGIN
			DECLARE COUNTRY_CURSOR CURSOR FOR 
       
				SELECT COUNTRY_CODE FROM  WC_BU_D 
				WHERE ROW_WID IN (
									SELECT ROW_WID FROM  WC_BU_D D
									 INNER JOIN  sys.tables ON COUNTRY_CODE = RIGHT(name,2)
								 WHERE name like 'MERGE_WC_RTLAUDIT_F%') AND COUNTRY_CODE IN ('UA','RO','SR')             
	         END    
SET @SQL1 ='IF  EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N''[dbo].[MERGE_WCV_RTLAUDIT_F_CIS]''))
DROP VIEW [dbo].[MERGE_WCV_RTLAUDIT_F_CIS]
GO
CREATE VIEW [dbo].[MERGE_WCV_RTLAUDIT_F_CIS] (
[ACCT_GEO_WID],
[EMP_WID],
[ETL_PROC_WID],
[FACING_POS_WID],
[INTEGRATION_ID],
[INVLOC_WID],
[LAST_AUDIT_FLG],
[OBJECTIVE_WID],
[OWNER_POSTN_WID],
[PROD_WID],
[RECORD_DATE_WID],
[ROW_WID],
[STORE_WID],
[BACK_STOCK],
[DISPLAY_FLG],
[DISPLAY_STOCK],
[FACING_NUM],
[FEATURE_FLG],
[LAST_REPLENISH_DT],
[OUT_OF_STOCK_FLG],
[PRICE_PT],
[ROTATED_FLG],
[SHELF_STOCK],
[TPR_FLG],
[TPR_PCT],
[U_EXCH_DT],
[U_PRICE_PT],
[VOID_FLG],
[U_CURCY_CD],
[ROW_LOAD_DT],
[ATTRIB_06],
[FK_01_WID],
[ATTRIB_31],
[ATTRIB_92],
[ATTRIB_93],
[ATTRIB_96],
[ATTRIB_61],
[ATTRIB_62],
[ATTRIB_52],
[ATTRIB_91],
[FK_04_WID],
[ATTRIB_54],
[ATTRIB_55],
[ATTRIB_56],
[ATTRIB_57],
[ATTRIB_60],
[ATTRIB_102],
[ATTRIB_103],
[ATTRIB_104],
[ATTRIB_105],
[FK_05_WID],
[FK_06_WID],
[ATTRIB_106],
[ATTRIB_107],
[ATTRIB_108],
[X_BU_ID],
[ATTRIB_109],
[ATTRIB_110],
[ATTRIB_111],
[ATTRIB_112],
[ATTRIB_113],
[ATTRIB_114],
[ATTRIB_115],
[ATTRIB_116],
[ATTRIB_117],
[ATTRIB_118],
[ATTRIB_119],
[ATTRIB_120],
[MONTH_WID],
[X_EXPIRED_QTY_RECALL],
[X_LAST_REPLENISH_DT],
[X_SALESMEN_PRESENCE_FLG],
[X_UNKNOWN_SOURCE_FLG],
[X_AVAILABILITY],
[X_OUT_OF_STOCK_FLG],
[ACTIVITY_ID],
[ACTIVITY_ACTUAL_START_DT_WID],
[STOCK_NUM],
[X_QTY_MERCHANDISED],
[X_SUGGESTED_FLG],
[X_DAYS_NXT_ORD_NUM],
[ATTRIB_04],
[ATTRIB_05],
[ATTRIB_121],
[ATTRIB_122],
[ATTRIB_123],
[BRAND_WID],
[GEO_WID],
[GEO_SEC_WID],
[X_DOMESTIC_PRICE],
[X_AVAILABLE_STOCK_NUM],
[X_CONTRACTED_FLG],
[X_EXCHANGED_LABEL_NUM],
[X_RETRO_FLG],
[VISIT_INPUT_DT],
[X_IN_STOCK_CD],
[X_PMP_FLG],
[X_EXPIRED_PRODUCTS_FLG],
[RTLAUDIT_PREV_WID],
[PERIOD_WID],
[DEVELOPMENT_DAY_FLG],
[X_REASON_CODE],
[X_IMPORTANCE_INDICATOR],
[X_SELLING_CARTON_AMT],
[X_SELLING_CARTON_AMT_USD],
[X_NB_FACINGS_OOS],
[X_SKU_POS_CD1],
[X_SKU_POS_CD2],
[X_OOS_REASON_CD],
[X_CONTRACT_PRD_FLG],
[X_JTI_OOS_EXIT_REASON_CD],
[X_AUDIT_WRONG_FLG],
[X_AUDIT_COMMENTS_TEXT],
[X_STD_PRICE_PACK_REACHED],
[X_STD_PRICE_CARTON_REACHED],
[X_ATTRIBUTE_1],
[X_SKU_POS_CD4],
[PERFRM_BY_PER_ID],
[X_PRESALE_FLG],
[X_ACTUAL_ORD_QTY_NUM],
[DELETE_FLAG],
[RI_FLG],
[X_CARTON_PLATFORM_CD],
[X_CARTON_LOCATION_CD],
[X_PACK_LOCATION_CD],
[X_PACK_PLATFORM_CD],
[X_INDUSTRY_FIXTURE_CD],
[X_FIXTURE_SIZE_CD],
[LAST_CYCLE_FLG],
[LAST_CYCLE_EMP_FLG],
[X_FACING_IMP_NUM],
[X_BU_WID],
[PROD_POSITION],
[ACTIVITY_TYPE],
[PROD_IMPORTANCE],
[TARGET_POS],
[FACING_POS],
[X_OUT_STOCK_CD],
[X_SIS_CONTRACT_FLG])
AS'
PRINT @SQL1

   --Open the Country cursor
			  			          
	OPEN COUNTRY_CURSOR

    FETCH NEXT FROM COUNTRY_CURSOR 
              INTO @COUNTRY_CODE
              
     WHILE @@FETCH_STATUS = 0
     BEGIN  
          
SET @SQL2 ='SELECT
[ACCT_GEO_WID],
[EMP_WID],
[ETL_PROC_WID],
[FACING_POS_WID],
[INTEGRATION_ID],
[INVLOC_WID],
[LAST_AUDIT_FLG],
[OBJECTIVE_WID],
[OWNER_POSTN_WID],
[PROD_WID],
[RECORD_DATE_WID],
[ROW_WID],
[STORE_WID],
[BACK_STOCK],
[DISPLAY_FLG],
[DISPLAY_STOCK],
[FACING_NUM],
[FEATURE_FLG],
[LAST_REPLENISH_DT],
[OUT_OF_STOCK_FLG],
[PRICE_PT],
[ROTATED_FLG],
[SHELF_STOCK],
[TPR_FLG],
[TPR_PCT],
[U_EXCH_DT],
[U_PRICE_PT],
[VOID_FLG],
[U_CURCY_CD],
[ROW_LOAD_DT],
[ATTRIB_06],
[FK_01_WID],
[ATTRIB_31],
[ATTRIB_92],
[ATTRIB_93],
[ATTRIB_96],
[ATTRIB_61],
[ATTRIB_62],
[ATTRIB_52],
[ATTRIB_91],
[FK_04_WID],
[ATTRIB_54],
[ATTRIB_55],
[ATTRIB_56],
[ATTRIB_57],
[ATTRIB_60],
[ATTRIB_102],
[ATTRIB_103],
[ATTRIB_104],
[ATTRIB_105],
[FK_05_WID],
[FK_06_WID],
[ATTRIB_106],
[ATTRIB_107],
[ATTRIB_108],
[X_BU_ID],
[ATTRIB_109],
[ATTRIB_110],
[ATTRIB_111],
[ATTRIB_112],
[ATTRIB_113],
[ATTRIB_114],
[ATTRIB_115],
[ATTRIB_116],
[ATTRIB_117],
[ATTRIB_118],
[ATTRIB_119],
[ATTRIB_120],
[MONTH_WID],
[X_EXPIRED_QTY_RECALL],
[X_LAST_REPLENISH_DT],
[X_SALESMEN_PRESENCE_FLG],
[X_UNKNOWN_SOURCE_FLG],
[X_AVAILABILITY],
[X_OUT_OF_STOCK_FLG],
[ACTIVITY_ID],
[ACTIVITY_ACTUAL_START_DT_WID],
[STOCK_NUM],
[X_QTY_MERCHANDISED],
[X_SUGGESTED_FLG],
[X_DAYS_NXT_ORD_NUM],
[ATTRIB_04],
[ATTRIB_05],
[ATTRIB_121],
[ATTRIB_122],
[ATTRIB_123],
[BRAND_WID],
[GEO_WID],
[GEO_SEC_WID],
[X_DOMESTIC_PRICE],
[X_AVAILABLE_STOCK_NUM],
[X_CONTRACTED_FLG],
[X_EXCHANGED_LABEL_NUM],
[X_RETRO_FLG],
[VISIT_INPUT_DT],
[X_IN_STOCK_CD],
[X_PMP_FLG],
[X_EXPIRED_PRODUCTS_FLG],
[RTLAUDIT_PREV_WID],
[PERIOD_WID],
[DEVELOPMENT_DAY_FLG],
[X_REASON_CODE],
[X_IMPORTANCE_INDICATOR],
[X_SELLING_CARTON_AMT],
[X_SELLING_CARTON_AMT_USD],
[X_NB_FACINGS_OOS],
[X_SKU_POS_CD1],
[X_SKU_POS_CD2],
[X_OOS_REASON_CD],
[X_CONTRACT_PRD_FLG],
[X_JTI_OOS_EXIT_REASON_CD],
[X_AUDIT_WRONG_FLG],
[X_AUDIT_COMMENTS_TEXT],
[X_STD_PRICE_PACK_REACHED],
[X_STD_PRICE_CARTON_REACHED],
[X_ATTRIBUTE_1],
[X_SKU_POS_CD4],
[PERFRM_BY_PER_ID],
[X_PRESALE_FLG],
[X_ACTUAL_ORD_QTY_NUM],
[DELETE_FLAG],
[RI_FLG],
[X_CARTON_PLATFORM_CD],
[X_CARTON_LOCATION_CD],
[X_PACK_LOCATION_CD],
[X_PACK_PLATFORM_CD],
[X_INDUSTRY_FIXTURE_CD],
[X_FIXTURE_SIZE_CD],
[LAST_CYCLE_FLG],
[LAST_CYCLE_EMP_FLG],
[X_FACING_IMP_NUM],
[X_BU_WID],
[PROD_POSITION],
[ACTIVITY_TYPE],
[PROD_IMPORTANCE],
[TARGET_POS],
[FACING_POS],
[X_OUT_STOCK_CD],
[X_SIS_CONTRACT_FLG] FROM MERGE_WC_RTLAUDIT_F_'+@COUNTRY_CODE+' 
UNION ALL '
PRINT @SQL2

FETCH NEXT FROM COUNTRY_CURSOR INTO @COUNTRY_CODE
                  END
       
              CLOSE COUNTRY_CURSOR
              DEALLOCATE COUNTRY_CURSOR

END
GO
--------------------------------------------MERGE_WC_RTLAUDIT_F VIEW ASI-------------------------------------
BEGIN
       DECLARE @COUNTRY_CODE  NVARCHAR (50),
                     @SQL1 NVARCHAR(4000),
                     @SQL2 NVARCHAR(4000)
                     
                     
			BEGIN
			DECLARE COUNTRY_CURSOR CURSOR FOR 
       
				SELECT COUNTRY_CODE FROM  WC_BU_D 
				WHERE ROW_WID IN (
									SELECT ROW_WID FROM  WC_BU_D D
									 INNER JOIN  sys.tables ON COUNTRY_CODE = RIGHT(name,2)
								 WHERE name like 'MERGE_WC_RTLAUDIT_F%') AND COUNTRY_CODE IN ('MY','TW','KR','KZ')             
	         END    
SET @SQL1 ='IF  EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N''[dbo].[MERGE_WCV_RTLAUDIT_F_ASI]''))
DROP VIEW [dbo].[MERGE_WCV_RTLAUDIT_F_ASI]
GO
CREATE VIEW [dbo].[MERGE_WCV_RTLAUDIT_F_ASI] (
[ACCT_GEO_WID],
[EMP_WID],
[ETL_PROC_WID],
[FACING_POS_WID],
[INTEGRATION_ID],
[INVLOC_WID],
[LAST_AUDIT_FLG],
[OBJECTIVE_WID],
[OWNER_POSTN_WID],
[PROD_WID],
[RECORD_DATE_WID],
[ROW_WID],
[STORE_WID],
[BACK_STOCK],
[DISPLAY_FLG],
[DISPLAY_STOCK],
[FACING_NUM],
[FEATURE_FLG],
[LAST_REPLENISH_DT],
[OUT_OF_STOCK_FLG],
[PRICE_PT],
[ROTATED_FLG],
[SHELF_STOCK],
[TPR_FLG],
[TPR_PCT],
[U_EXCH_DT],
[U_PRICE_PT],
[VOID_FLG],
[U_CURCY_CD],
[ROW_LOAD_DT],
[ATTRIB_06],
[FK_01_WID],
[ATTRIB_31],
[ATTRIB_92],
[ATTRIB_93],
[ATTRIB_96],
[ATTRIB_61],
[ATTRIB_62],
[ATTRIB_52],
[ATTRIB_91],
[FK_04_WID],
[ATTRIB_54],
[ATTRIB_55],
[ATTRIB_56],
[ATTRIB_57],
[ATTRIB_60],
[ATTRIB_102],
[ATTRIB_103],
[ATTRIB_104],
[ATTRIB_105],
[FK_05_WID],
[FK_06_WID],
[ATTRIB_106],
[ATTRIB_107],
[ATTRIB_108],
[X_BU_ID],
[ATTRIB_109],
[ATTRIB_110],
[ATTRIB_111],
[ATTRIB_112],
[ATTRIB_113],
[ATTRIB_114],
[ATTRIB_115],
[ATTRIB_116],
[ATTRIB_117],
[ATTRIB_118],
[ATTRIB_119],
[ATTRIB_120],
[MONTH_WID],
[X_EXPIRED_QTY_RECALL],
[X_LAST_REPLENISH_DT],
[X_SALESMEN_PRESENCE_FLG],
[X_UNKNOWN_SOURCE_FLG],
[X_AVAILABILITY],
[X_OUT_OF_STOCK_FLG],
[ACTIVITY_ID],
[ACTIVITY_ACTUAL_START_DT_WID],
[STOCK_NUM],
[X_QTY_MERCHANDISED],
[X_SUGGESTED_FLG],
[X_DAYS_NXT_ORD_NUM],
[ATTRIB_04],
[ATTRIB_05],
[ATTRIB_121],
[ATTRIB_122],
[ATTRIB_123],
[BRAND_WID],
[GEO_WID],
[GEO_SEC_WID],
[X_DOMESTIC_PRICE],
[X_AVAILABLE_STOCK_NUM],
[X_CONTRACTED_FLG],
[X_EXCHANGED_LABEL_NUM],
[X_RETRO_FLG],
[VISIT_INPUT_DT],
[X_IN_STOCK_CD],
[X_PMP_FLG],
[X_EXPIRED_PRODUCTS_FLG],
[RTLAUDIT_PREV_WID],
[PERIOD_WID],
[DEVELOPMENT_DAY_FLG],
[X_REASON_CODE],
[X_IMPORTANCE_INDICATOR],
[X_SELLING_CARTON_AMT],
[X_SELLING_CARTON_AMT_USD],
[X_NB_FACINGS_OOS],
[X_SKU_POS_CD1],
[X_SKU_POS_CD2],
[X_OOS_REASON_CD],
[X_CONTRACT_PRD_FLG],
[X_JTI_OOS_EXIT_REASON_CD],
[X_AUDIT_WRONG_FLG],
[X_AUDIT_COMMENTS_TEXT],
[X_STD_PRICE_PACK_REACHED],
[X_STD_PRICE_CARTON_REACHED],
[X_ATTRIBUTE_1],
[X_SKU_POS_CD4],
[PERFRM_BY_PER_ID],
[X_PRESALE_FLG],
[X_ACTUAL_ORD_QTY_NUM],
[DELETE_FLAG],
[RI_FLG],
[X_CARTON_PLATFORM_CD],
[X_CARTON_LOCATION_CD],
[X_PACK_LOCATION_CD],
[X_PACK_PLATFORM_CD],
[X_INDUSTRY_FIXTURE_CD],
[X_FIXTURE_SIZE_CD],
[LAST_CYCLE_FLG],
[LAST_CYCLE_EMP_FLG],
[X_FACING_IMP_NUM],
[X_BU_WID],
[PROD_POSITION],
[ACTIVITY_TYPE],
[PROD_IMPORTANCE],
[TARGET_POS],
[FACING_POS],
[X_OUT_STOCK_CD],
[X_SIS_CONTRACT_FLG])
AS'
PRINT @SQL1

   --Open the Country cursor
			  			          
	OPEN COUNTRY_CURSOR

    FETCH NEXT FROM COUNTRY_CURSOR 
              INTO @COUNTRY_CODE
              
     WHILE @@FETCH_STATUS = 0
     BEGIN  
          
SET @SQL2 ='SELECT
[ACCT_GEO_WID],
[EMP_WID],
[ETL_PROC_WID],
[FACING_POS_WID],
[INTEGRATION_ID],
[INVLOC_WID],
[LAST_AUDIT_FLG],
[OBJECTIVE_WID],
[OWNER_POSTN_WID],
[PROD_WID],
[RECORD_DATE_WID],
[ROW_WID],
[STORE_WID],
[BACK_STOCK],
[DISPLAY_FLG],
[DISPLAY_STOCK],
[FACING_NUM],
[FEATURE_FLG],
[LAST_REPLENISH_DT],
[OUT_OF_STOCK_FLG],
[PRICE_PT],
[ROTATED_FLG],
[SHELF_STOCK],
[TPR_FLG],
[TPR_PCT],
[U_EXCH_DT],
[U_PRICE_PT],
[VOID_FLG],
[U_CURCY_CD],
[ROW_LOAD_DT],
[ATTRIB_06],
[FK_01_WID],
[ATTRIB_31],
[ATTRIB_92],
[ATTRIB_93],
[ATTRIB_96],
[ATTRIB_61],
[ATTRIB_62],
[ATTRIB_52],
[ATTRIB_91],
[FK_04_WID],
[ATTRIB_54],
[ATTRIB_55],
[ATTRIB_56],
[ATTRIB_57],
[ATTRIB_60],
[ATTRIB_102],
[ATTRIB_103],
[ATTRIB_104],
[ATTRIB_105],
[FK_05_WID],
[FK_06_WID],
[ATTRIB_106],
[ATTRIB_107],
[ATTRIB_108],
[X_BU_ID],
[ATTRIB_109],
[ATTRIB_110],
[ATTRIB_111],
[ATTRIB_112],
[ATTRIB_113],
[ATTRIB_114],
[ATTRIB_115],
[ATTRIB_116],
[ATTRIB_117],
[ATTRIB_118],
[ATTRIB_119],
[ATTRIB_120],
[MONTH_WID],
[X_EXPIRED_QTY_RECALL],
[X_LAST_REPLENISH_DT],
[X_SALESMEN_PRESENCE_FLG],
[X_UNKNOWN_SOURCE_FLG],
[X_AVAILABILITY],
[X_OUT_OF_STOCK_FLG],
[ACTIVITY_ID],
[ACTIVITY_ACTUAL_START_DT_WID],
[STOCK_NUM],
[X_QTY_MERCHANDISED],
[X_SUGGESTED_FLG],
[X_DAYS_NXT_ORD_NUM],
[ATTRIB_04],
[ATTRIB_05],
[ATTRIB_121],
[ATTRIB_122],
[ATTRIB_123],
[BRAND_WID],
[GEO_WID],
[GEO_SEC_WID],
[X_DOMESTIC_PRICE],
[X_AVAILABLE_STOCK_NUM],
[X_CONTRACTED_FLG],
[X_EXCHANGED_LABEL_NUM],
[X_RETRO_FLG],
[VISIT_INPUT_DT],
[X_IN_STOCK_CD],
[X_PMP_FLG],
[X_EXPIRED_PRODUCTS_FLG],
[RTLAUDIT_PREV_WID],
[PERIOD_WID],
[DEVELOPMENT_DAY_FLG],
[X_REASON_CODE],
[X_IMPORTANCE_INDICATOR],
[X_SELLING_CARTON_AMT],
[X_SELLING_CARTON_AMT_USD],
[X_NB_FACINGS_OOS],
[X_SKU_POS_CD1],
[X_SKU_POS_CD2],
[X_OOS_REASON_CD],
[X_CONTRACT_PRD_FLG],
[X_JTI_OOS_EXIT_REASON_CD],
[X_AUDIT_WRONG_FLG],
[X_AUDIT_COMMENTS_TEXT],
[X_STD_PRICE_PACK_REACHED],
[X_STD_PRICE_CARTON_REACHED],
[X_ATTRIBUTE_1],
[X_SKU_POS_CD4],
[PERFRM_BY_PER_ID],
[X_PRESALE_FLG],
[X_ACTUAL_ORD_QTY_NUM],
[DELETE_FLAG],
[RI_FLG],
[X_CARTON_PLATFORM_CD],
[X_CARTON_LOCATION_CD],
[X_PACK_LOCATION_CD],
[X_PACK_PLATFORM_CD],
[X_INDUSTRY_FIXTURE_CD],
[X_FIXTURE_SIZE_CD],
[LAST_CYCLE_FLG],
[LAST_CYCLE_EMP_FLG],
[X_FACING_IMP_NUM],
[X_BU_WID],
[PROD_POSITION],
[ACTIVITY_TYPE],
[PROD_IMPORTANCE],
[TARGET_POS],
[FACING_POS],
[X_OUT_STOCK_CD],
[X_SIS_CONTRACT_FLG] FROM MERGE_WC_RTLAUDIT_F_'+@COUNTRY_CODE+' 
UNION ALL '
PRINT @SQL2

FETCH NEXT FROM COUNTRY_CURSOR INTO @COUNTRY_CODE
                  END
       
              CLOSE COUNTRY_CURSOR
              DEALLOCATE COUNTRY_CURSOR

END
GO
--------------------------------------------MERGE_WC_RTLAUDIT_F VIEW CEU-------------------------------------
BEGIN
       DECLARE @COUNTRY_CODE  NVARCHAR (50),
                     @SQL1 NVARCHAR(4000),
                     @SQL2 NVARCHAR(4000)
                     
                     
			BEGIN
			DECLARE COUNTRY_CURSOR CURSOR FOR 
       
				SELECT COUNTRY_CODE FROM  WC_BU_D 
				WHERE ROW_WID IN (
									SELECT ROW_WID FROM  WC_BU_D D
									 INNER JOIN  sys.tables ON COUNTRY_CODE = RIGHT(name,2)
								 WHERE name like 'MERGE_WC_RTLAUDIT_F%') AND COUNTRY_CODE IN ('GE','CZ','PL','WW','GR')             
	         END    
SET @SQL1 ='IF  EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N''[dbo].[MERGE_WCV_RTLAUDIT_F_CEU]''))
DROP VIEW [dbo].[MERGE_WCV_RTLAUDIT_F_CEU]
GO
CREATE VIEW [dbo].[MERGE_WCV_RTLAUDIT_F_CEU] (
[ACCT_GEO_WID],
[EMP_WID],
[ETL_PROC_WID],
[FACING_POS_WID],
[INTEGRATION_ID],
[INVLOC_WID],
[LAST_AUDIT_FLG],
[OBJECTIVE_WID],
[OWNER_POSTN_WID],
[PROD_WID],
[RECORD_DATE_WID],
[ROW_WID],
[STORE_WID],
[BACK_STOCK],
[DISPLAY_FLG],
[DISPLAY_STOCK],
[FACING_NUM],
[FEATURE_FLG],
[LAST_REPLENISH_DT],
[OUT_OF_STOCK_FLG],
[PRICE_PT],
[ROTATED_FLG],
[SHELF_STOCK],
[TPR_FLG],
[TPR_PCT],
[U_EXCH_DT],
[U_PRICE_PT],
[VOID_FLG],
[U_CURCY_CD],
[ROW_LOAD_DT],
[ATTRIB_06],
[FK_01_WID],
[ATTRIB_31],
[ATTRIB_92],
[ATTRIB_93],
[ATTRIB_96],
[ATTRIB_61],
[ATTRIB_62],
[ATTRIB_52],
[ATTRIB_91],
[FK_04_WID],
[ATTRIB_54],
[ATTRIB_55],
[ATTRIB_56],
[ATTRIB_57],
[ATTRIB_60],
[ATTRIB_102],
[ATTRIB_103],
[ATTRIB_104],
[ATTRIB_105],
[FK_05_WID],
[FK_06_WID],
[ATTRIB_106],
[ATTRIB_107],
[ATTRIB_108],
[X_BU_ID],
[ATTRIB_109],
[ATTRIB_110],
[ATTRIB_111],
[ATTRIB_112],
[ATTRIB_113],
[ATTRIB_114],
[ATTRIB_115],
[ATTRIB_116],
[ATTRIB_117],
[ATTRIB_118],
[ATTRIB_119],
[ATTRIB_120],
[MONTH_WID],
[X_EXPIRED_QTY_RECALL],
[X_LAST_REPLENISH_DT],
[X_SALESMEN_PRESENCE_FLG],
[X_UNKNOWN_SOURCE_FLG],
[X_AVAILABILITY],
[X_OUT_OF_STOCK_FLG],
[ACTIVITY_ID],
[ACTIVITY_ACTUAL_START_DT_WID],
[STOCK_NUM],
[X_QTY_MERCHANDISED],
[X_SUGGESTED_FLG],
[X_DAYS_NXT_ORD_NUM],
[ATTRIB_04],
[ATTRIB_05],
[ATTRIB_121],
[ATTRIB_122],
[ATTRIB_123],
[BRAND_WID],
[GEO_WID],
[GEO_SEC_WID],
[X_DOMESTIC_PRICE],
[X_AVAILABLE_STOCK_NUM],
[X_CONTRACTED_FLG],
[X_EXCHANGED_LABEL_NUM],
[X_RETRO_FLG],
[VISIT_INPUT_DT],
[X_IN_STOCK_CD],
[X_PMP_FLG],
[X_EXPIRED_PRODUCTS_FLG],
[RTLAUDIT_PREV_WID],
[PERIOD_WID],
[DEVELOPMENT_DAY_FLG],
[X_REASON_CODE],
[X_IMPORTANCE_INDICATOR],
[X_SELLING_CARTON_AMT],
[X_SELLING_CARTON_AMT_USD],
[X_NB_FACINGS_OOS],
[X_SKU_POS_CD1],
[X_SKU_POS_CD2],
[X_OOS_REASON_CD],
[X_CONTRACT_PRD_FLG],
[X_JTI_OOS_EXIT_REASON_CD],
[X_AUDIT_WRONG_FLG],
[X_AUDIT_COMMENTS_TEXT],
[X_STD_PRICE_PACK_REACHED],
[X_STD_PRICE_CARTON_REACHED],
[X_ATTRIBUTE_1],
[X_SKU_POS_CD4],
[PERFRM_BY_PER_ID],
[X_PRESALE_FLG],
[X_ACTUAL_ORD_QTY_NUM],
[DELETE_FLAG],
[RI_FLG],
[X_CARTON_PLATFORM_CD],
[X_CARTON_LOCATION_CD],
[X_PACK_LOCATION_CD],
[X_PACK_PLATFORM_CD],
[X_INDUSTRY_FIXTURE_CD],
[X_FIXTURE_SIZE_CD],
[LAST_CYCLE_FLG],
[LAST_CYCLE_EMP_FLG],
[X_FACING_IMP_NUM],
[X_BU_WID],
[PROD_POSITION],
[ACTIVITY_TYPE],
[PROD_IMPORTANCE],
[TARGET_POS],
[FACING_POS],
[X_OUT_STOCK_CD],
[X_SIS_CONTRACT_FLG])
AS'
PRINT @SQL1

   --Open the Country cursor
			  			          
	OPEN COUNTRY_CURSOR

    FETCH NEXT FROM COUNTRY_CURSOR 
              INTO @COUNTRY_CODE
              
     WHILE @@FETCH_STATUS = 0
     BEGIN  
          
SET @SQL2 ='SELECT
[ACCT_GEO_WID],
[EMP_WID],
[ETL_PROC_WID],
[FACING_POS_WID],
[INTEGRATION_ID],
[INVLOC_WID],
[LAST_AUDIT_FLG],
[OBJECTIVE_WID],
[OWNER_POSTN_WID],
[PROD_WID],
[RECORD_DATE_WID],
[ROW_WID],
[STORE_WID],
[BACK_STOCK],
[DISPLAY_FLG],
[DISPLAY_STOCK],
[FACING_NUM],
[FEATURE_FLG],
[LAST_REPLENISH_DT],
[OUT_OF_STOCK_FLG],
[PRICE_PT],
[ROTATED_FLG],
[SHELF_STOCK],
[TPR_FLG],
[TPR_PCT],
[U_EXCH_DT],
[U_PRICE_PT],
[VOID_FLG],
[U_CURCY_CD],
[ROW_LOAD_DT],
[ATTRIB_06],
[FK_01_WID],
[ATTRIB_31],
[ATTRIB_92],
[ATTRIB_93],
[ATTRIB_96],
[ATTRIB_61],
[ATTRIB_62],
[ATTRIB_52],
[ATTRIB_91],
[FK_04_WID],
[ATTRIB_54],
[ATTRIB_55],
[ATTRIB_56],
[ATTRIB_57],
[ATTRIB_60],
[ATTRIB_102],
[ATTRIB_103],
[ATTRIB_104],
[ATTRIB_105],
[FK_05_WID],
[FK_06_WID],
[ATTRIB_106],
[ATTRIB_107],
[ATTRIB_108],
[X_BU_ID],
[ATTRIB_109],
[ATTRIB_110],
[ATTRIB_111],
[ATTRIB_112],
[ATTRIB_113],
[ATTRIB_114],
[ATTRIB_115],
[ATTRIB_116],
[ATTRIB_117],
[ATTRIB_118],
[ATTRIB_119],
[ATTRIB_120],
[MONTH_WID],
[X_EXPIRED_QTY_RECALL],
[X_LAST_REPLENISH_DT],
[X_SALESMEN_PRESENCE_FLG],
[X_UNKNOWN_SOURCE_FLG],
[X_AVAILABILITY],
[X_OUT_OF_STOCK_FLG],
[ACTIVITY_ID],
[ACTIVITY_ACTUAL_START_DT_WID],
[STOCK_NUM],
[X_QTY_MERCHANDISED],
[X_SUGGESTED_FLG],
[X_DAYS_NXT_ORD_NUM],
[ATTRIB_04],
[ATTRIB_05],
[ATTRIB_121],
[ATTRIB_122],
[ATTRIB_123],
[BRAND_WID],
[GEO_WID],
[GEO_SEC_WID],
[X_DOMESTIC_PRICE],
[X_AVAILABLE_STOCK_NUM],
[X_CONTRACTED_FLG],
[X_EXCHANGED_LABEL_NUM],
[X_RETRO_FLG],
[VISIT_INPUT_DT],
[X_IN_STOCK_CD],
[X_PMP_FLG],
[X_EXPIRED_PRODUCTS_FLG],
[RTLAUDIT_PREV_WID],
[PERIOD_WID],
[DEVELOPMENT_DAY_FLG],
[X_REASON_CODE],
[X_IMPORTANCE_INDICATOR],
[X_SELLING_CARTON_AMT],
[X_SELLING_CARTON_AMT_USD],
[X_NB_FACINGS_OOS],
[X_SKU_POS_CD1],
[X_SKU_POS_CD2],
[X_OOS_REASON_CD],
[X_CONTRACT_PRD_FLG],
[X_JTI_OOS_EXIT_REASON_CD],
[X_AUDIT_WRONG_FLG],
[X_AUDIT_COMMENTS_TEXT],
[X_STD_PRICE_PACK_REACHED],
[X_STD_PRICE_CARTON_REACHED],
[X_ATTRIBUTE_1],
[X_SKU_POS_CD4],
[PERFRM_BY_PER_ID],
[X_PRESALE_FLG],
[X_ACTUAL_ORD_QTY_NUM],
[DELETE_FLAG],
[RI_FLG],
[X_CARTON_PLATFORM_CD],
[X_CARTON_LOCATION_CD],
[X_PACK_LOCATION_CD],
[X_PACK_PLATFORM_CD],
[X_INDUSTRY_FIXTURE_CD],
[X_FIXTURE_SIZE_CD],
[LAST_CYCLE_FLG],
[LAST_CYCLE_EMP_FLG],
[X_FACING_IMP_NUM],
[X_BU_WID],
[PROD_POSITION],
[ACTIVITY_TYPE],
[PROD_IMPORTANCE],
[TARGET_POS],
[FACING_POS],
[X_OUT_STOCK_CD],
[X_SIS_CONTRACT_FLG] FROM MERGE_WC_RTLAUDIT_F_'+@COUNTRY_CODE+' 
UNION ALL '
PRINT @SQL2

FETCH NEXT FROM COUNTRY_CURSOR INTO @COUNTRY_CODE
                  END
       
              CLOSE COUNTRY_CURSOR
              DEALLOCATE COUNTRY_CURSOR

END
--------------------------------------------MERGE_WC_RTLAUDIT_F VIEW RUS-------------------------------------
BEGIN
       DECLARE @COUNTRY_CODE  NVARCHAR (50),
                     @SQL1 NVARCHAR(4000),
                     @SQL2 NVARCHAR(4000)
                     
                     
			BEGIN
			DECLARE COUNTRY_CURSOR CURSOR FOR 
       
				SELECT COUNTRY_CODE FROM  WC_BU_D 
				WHERE ROW_WID IN (
									SELECT ROW_WID FROM  WC_BU_D D
									 INNER JOIN  sys.tables ON COUNTRY_CODE = RIGHT(name,2)
								 WHERE name like 'MERGE_WC_RTLAUDIT_F%') AND COUNTRY_CODE ='RU'            
	         END    
SET @SQL1 ='IF  EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N''[dbo].[MERGE_WCV_RTLAUDIT_F_RUS]''))
DROP VIEW [dbo].[MERGE_WCV_RTLAUDIT_F_RUS]
GO
CREATE VIEW [dbo].[MERGE_WCV_RTLAUDIT_F_RUS] (
[ACCT_GEO_WID],
[EMP_WID],
[ETL_PROC_WID],
[FACING_POS_WID],
[INTEGRATION_ID],
[INVLOC_WID],
[LAST_AUDIT_FLG],
[OBJECTIVE_WID],
[OWNER_POSTN_WID],
[PROD_WID],
[RECORD_DATE_WID],
[ROW_WID],
[STORE_WID],
[BACK_STOCK],
[DISPLAY_FLG],
[DISPLAY_STOCK],
[FACING_NUM],
[FEATURE_FLG],
[LAST_REPLENISH_DT],
[OUT_OF_STOCK_FLG],
[PRICE_PT],
[ROTATED_FLG],
[SHELF_STOCK],
[TPR_FLG],
[TPR_PCT],
[U_EXCH_DT],
[U_PRICE_PT],
[VOID_FLG],
[U_CURCY_CD],
[ROW_LOAD_DT],
[ATTRIB_06],
[FK_01_WID],
[ATTRIB_31],
[ATTRIB_92],
[ATTRIB_93],
[ATTRIB_96],
[ATTRIB_61],
[ATTRIB_62],
[ATTRIB_52],
[ATTRIB_91],
[FK_04_WID],
[ATTRIB_54],
[ATTRIB_55],
[ATTRIB_56],
[ATTRIB_57],
[ATTRIB_60],
[ATTRIB_102],
[ATTRIB_103],
[ATTRIB_104],
[ATTRIB_105],
[FK_05_WID],
[FK_06_WID],
[ATTRIB_106],
[ATTRIB_107],
[ATTRIB_108],
[X_BU_ID],
[ATTRIB_109],
[ATTRIB_110],
[ATTRIB_111],
[ATTRIB_112],
[ATTRIB_113],
[ATTRIB_114],
[ATTRIB_115],
[ATTRIB_116],
[ATTRIB_117],
[ATTRIB_118],
[ATTRIB_119],
[ATTRIB_120],
[MONTH_WID],
[X_EXPIRED_QTY_RECALL],
[X_LAST_REPLENISH_DT],
[X_SALESMEN_PRESENCE_FLG],
[X_UNKNOWN_SOURCE_FLG],
[X_AVAILABILITY],
[X_OUT_OF_STOCK_FLG],
[ACTIVITY_ID],
[ACTIVITY_ACTUAL_START_DT_WID],
[STOCK_NUM],
[X_QTY_MERCHANDISED],
[X_SUGGESTED_FLG],
[X_DAYS_NXT_ORD_NUM],
[ATTRIB_04],
[ATTRIB_05],
[ATTRIB_121],
[ATTRIB_122],
[ATTRIB_123],
[BRAND_WID],
[GEO_WID],
[GEO_SEC_WID],
[X_DOMESTIC_PRICE],
[X_AVAILABLE_STOCK_NUM],
[X_CONTRACTED_FLG],
[X_EXCHANGED_LABEL_NUM],
[X_RETRO_FLG],
[VISIT_INPUT_DT],
[X_IN_STOCK_CD],
[X_PMP_FLG],
[X_EXPIRED_PRODUCTS_FLG],
[RTLAUDIT_PREV_WID],
[PERIOD_WID],
[DEVELOPMENT_DAY_FLG],
[X_REASON_CODE],
[X_IMPORTANCE_INDICATOR],
[X_SELLING_CARTON_AMT],
[X_SELLING_CARTON_AMT_USD],
[X_NB_FACINGS_OOS],
[X_SKU_POS_CD1],
[X_SKU_POS_CD2],
[X_OOS_REASON_CD],
[X_CONTRACT_PRD_FLG],
[X_JTI_OOS_EXIT_REASON_CD],
[X_AUDIT_WRONG_FLG],
[X_AUDIT_COMMENTS_TEXT],
[X_STD_PRICE_PACK_REACHED],
[X_STD_PRICE_CARTON_REACHED],
[X_ATTRIBUTE_1],
[X_SKU_POS_CD4],
[PERFRM_BY_PER_ID],
[X_PRESALE_FLG],
[X_ACTUAL_ORD_QTY_NUM],
[DELETE_FLAG],
[RI_FLG],
[X_CARTON_PLATFORM_CD],
[X_CARTON_LOCATION_CD],
[X_PACK_LOCATION_CD],
[X_PACK_PLATFORM_CD],
[X_INDUSTRY_FIXTURE_CD],
[X_FIXTURE_SIZE_CD],
[LAST_CYCLE_FLG],
[LAST_CYCLE_EMP_FLG],
[X_FACING_IMP_NUM],
[X_BU_WID],
[PROD_POSITION],
[ACTIVITY_TYPE],
[PROD_IMPORTANCE],
[TARGET_POS],
[FACING_POS],
[X_OUT_STOCK_CD],
[X_SIS_CONTRACT_FLG])
AS'
PRINT @SQL1

   --Open the Country cursor
			  			          
	OPEN COUNTRY_CURSOR

    FETCH NEXT FROM COUNTRY_CURSOR 
              INTO @COUNTRY_CODE
              
     WHILE @@FETCH_STATUS = 0
     BEGIN  
          
SET @SQL2 ='SELECT
[ACCT_GEO_WID],
[EMP_WID],
[ETL_PROC_WID],
[FACING_POS_WID],
[INTEGRATION_ID],
[INVLOC_WID],
[LAST_AUDIT_FLG],
[OBJECTIVE_WID],
[OWNER_POSTN_WID],
[PROD_WID],
[RECORD_DATE_WID],
[ROW_WID],
[STORE_WID],
[BACK_STOCK],
[DISPLAY_FLG],
[DISPLAY_STOCK],
[FACING_NUM],
[FEATURE_FLG],
[LAST_REPLENISH_DT],
[OUT_OF_STOCK_FLG],
[PRICE_PT],
[ROTATED_FLG],
[SHELF_STOCK],
[TPR_FLG],
[TPR_PCT],
[U_EXCH_DT],
[U_PRICE_PT],
[VOID_FLG],
[U_CURCY_CD],
[ROW_LOAD_DT],
[ATTRIB_06],
[FK_01_WID],
[ATTRIB_31],
[ATTRIB_92],
[ATTRIB_93],
[ATTRIB_96],
[ATTRIB_61],
[ATTRIB_62],
[ATTRIB_52],
[ATTRIB_91],
[FK_04_WID],
[ATTRIB_54],
[ATTRIB_55],
[ATTRIB_56],
[ATTRIB_57],
[ATTRIB_60],
[ATTRIB_102],
[ATTRIB_103],
[ATTRIB_104],
[ATTRIB_105],
[FK_05_WID],
[FK_06_WID],
[ATTRIB_106],
[ATTRIB_107],
[ATTRIB_108],
[X_BU_ID],
[ATTRIB_109],
[ATTRIB_110],
[ATTRIB_111],
[ATTRIB_112],
[ATTRIB_113],
[ATTRIB_114],
[ATTRIB_115],
[ATTRIB_116],
[ATTRIB_117],
[ATTRIB_118],
[ATTRIB_119],
[ATTRIB_120],
[MONTH_WID],
[X_EXPIRED_QTY_RECALL],
[X_LAST_REPLENISH_DT],
[X_SALESMEN_PRESENCE_FLG],
[X_UNKNOWN_SOURCE_FLG],
[X_AVAILABILITY],
[X_OUT_OF_STOCK_FLG],
[ACTIVITY_ID],
[ACTIVITY_ACTUAL_START_DT_WID],
[STOCK_NUM],
[X_QTY_MERCHANDISED],
[X_SUGGESTED_FLG],
[X_DAYS_NXT_ORD_NUM],
[ATTRIB_04],
[ATTRIB_05],
[ATTRIB_121],
[ATTRIB_122],
[ATTRIB_123],
[BRAND_WID],
[GEO_WID],
[GEO_SEC_WID],
[X_DOMESTIC_PRICE],
[X_AVAILABLE_STOCK_NUM],
[X_CONTRACTED_FLG],
[X_EXCHANGED_LABEL_NUM],
[X_RETRO_FLG],
[VISIT_INPUT_DT],
[X_IN_STOCK_CD],
[X_PMP_FLG],
[X_EXPIRED_PRODUCTS_FLG],
[RTLAUDIT_PREV_WID],
[PERIOD_WID],
[DEVELOPMENT_DAY_FLG],
[X_REASON_CODE],
[X_IMPORTANCE_INDICATOR],
[X_SELLING_CARTON_AMT],
[X_SELLING_CARTON_AMT_USD],
[X_NB_FACINGS_OOS],
[X_SKU_POS_CD1],
[X_SKU_POS_CD2],
[X_OOS_REASON_CD],
[X_CONTRACT_PRD_FLG],
[X_JTI_OOS_EXIT_REASON_CD],
[X_AUDIT_WRONG_FLG],
[X_AUDIT_COMMENTS_TEXT],
[X_STD_PRICE_PACK_REACHED],
[X_STD_PRICE_CARTON_REACHED],
[X_ATTRIBUTE_1],
[X_SKU_POS_CD4],
[PERFRM_BY_PER_ID],
[X_PRESALE_FLG],
[X_ACTUAL_ORD_QTY_NUM],
[DELETE_FLAG],
[RI_FLG],
[X_CARTON_PLATFORM_CD],
[X_CARTON_LOCATION_CD],
[X_PACK_LOCATION_CD],
[X_PACK_PLATFORM_CD],
[X_INDUSTRY_FIXTURE_CD],
[X_FIXTURE_SIZE_CD],
[LAST_CYCLE_FLG],
[LAST_CYCLE_EMP_FLG],
[X_FACING_IMP_NUM],
[X_BU_WID],
[PROD_POSITION],
[ACTIVITY_TYPE],
[PROD_IMPORTANCE],
[TARGET_POS],
[FACING_POS],
[X_OUT_STOCK_CD],
[X_SIS_CONTRACT_FLG] FROM MERGE_WC_RTLAUDIT_F_'+@COUNTRY_CODE+' 
UNION ALL '
PRINT @SQL2

FETCH NEXT FROM COUNTRY_CURSOR INTO @COUNTRY_CODE
                  END
       
              CLOSE COUNTRY_CURSOR
              DEALLOCATE COUNTRY_CURSOR

END